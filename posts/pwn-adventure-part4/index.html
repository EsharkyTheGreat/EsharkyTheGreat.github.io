<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="PwnAdventure Part4 - Function Hijacking" /><meta property="og:locale" content="en" /><meta name="description" content="Developing our First Hack In this post I’m going over our first step to develop a hack. The way we are going to do it is we are going to overwrite functions in the libGameLogic.so by writing our own library and the LD_PRELOAD in it. This is why we built the header file to get the correct offsets of objects and getting the function definitions." /><meta property="og:description" content="Developing our First Hack In this post I’m going over our first step to develop a hack. The way we are going to do it is we are going to overwrite functions in the libGameLogic.so by writing our own library and the LD_PRELOAD in it. This is why we built the header file to get the correct offsets of objects and getting the function definitions." /><link rel="canonical" href="/posts/pwn-adventure-part4/" /><meta property="og:url" content="/posts/pwn-adventure-part4/" /><meta property="og:site_name" content="EsharkyTheGreat’s Personal Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-27T12:02:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PwnAdventure Part4 - Function Hijacking" /><meta name="twitter:site" content="@eshwars1210" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-01-27T12:02:00+05:30","datePublished":"2022-01-27T12:02:00+05:30","description":"Developing our First Hack In this post I’m going over our first step to develop a hack. The way we are going to do it is we are going to overwrite functions in the libGameLogic.so by writing our own library and the LD_PRELOAD in it. This is why we built the header file to get the correct offsets of objects and getting the function definitions.","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/pwn-adventure-part4/"},"url":"/posts/pwn-adventure-part4/","@type":"BlogPosting","headline":"PwnAdventure Part4 - Function Hijacking","@context":"https://schema.org"}</script><title>PwnAdventure Part4 - Function Hijacking | EsharkyTheGreat's Personal Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EsharkyTheGreat's Personal Blog"><meta name="application-name" content="EsharkyTheGreat's Personal Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/uchihaSasuke.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">EsharkyTheGreat's Personal Blog</a></div><div class="site-subtitle font-italic">Cyber Sec Enthusiast | Binary Exploitation | IIT(BHU)'24 | CTF w/ IIT(BHU)CyberSec'</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/EsharkyTheGreat" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/eshwars1210" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['eshwars1210','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>PwnAdventure Part4 - Function Hijacking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PwnAdventure Part4 - Function Hijacking</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> EsharkyTheGreat </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jan 27, 2022, 12:02 PM +0530" >Jan 27<i class="unloaded">2022-01-27T12:02:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="732 words">4 min read</span></div></div><div class="post-content"><h2 id="developing-our-first-hack">Developing our First Hack</h2><hr /><p>In this post I’m going over our first step to develop a hack. The way we are going to do it is we are going to overwrite functions in the <code class="language-plaintext highlighter-rouge">libGameLogic.so</code> by writing our own library and the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> in it. This is why we built the header file to get the correct offsets of objects and getting the function definitions.</p><h2 id="testing-ld_preload">Testing LD_PRELOAD</h2><hr /><p>Let’s test our <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> function hooking by hooking a simple function and console logging the output. So what we’re going to do is hook the <code class="language-plaintext highlighter-rouge">Player::SetJumpState(bool b)</code> function and just outputing the value of b to check if we are able to hook the function.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span text-data=" Cpp "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include "libGameLogic.h"
#include &lt;set&gt;
#include &lt;dlfcn.h&gt;
#include &lt;map&gt;
#include &lt;functional&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;cfloat&gt;
#include &lt;memory&gt;
#include &lt;stdint.h&gt;
</span>
<span class="kt">void</span> <span class="n">Player</span><span class="o">::</span><span class="n">SetJumpState</span><span class="p">(</span><span class="kt">bool</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[*] SetJumpState(%d)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This is how we are going to hook the function and check the value. We have to be careful how we compile it as we have to compile it a shared library and make it position independant.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>g++ jumpHook.cpp <span class="nt">-std</span><span class="o">=</span>c++11 <span class="nt">-shared</span> <span class="nt">-o</span> myLib.so <span class="nt">-fPIC</span>
</pre></table></code></div></div><p>Here <code class="language-plaintext highlighter-rouge">-shared</code> is to signify that we want it to be compiled as a shared object file and <code class="language-plaintext highlighter-rouge">-fPIC</code> so that it is position independant.</p><blockquote><p>Keep in mind that we are overwriting the function body entirely and not calling the functions being called after this i.e we are not sending the server information that we are jumping so we would only be jumping in our client and would’nt appear to be jumping to others.</p></blockquote><h2 id="our-target-function">Our Target Function</h2><hr /><p>Since we know that we can hook any function we’ll search for a function which is kinda useless and can be called upon easily. Liveoverflow finds the function <code class="language-plaintext highlighter-rouge">World::tick(float f)</code>. We can hook this and see what argument it is getting.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span text-data=" Cpp "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include "libGameLogic.h"
#include &lt;set&gt;
#include &lt;dlfcn.h&gt;
#include &lt;map&gt;
#include &lt;functional&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;cfloat&gt;
#include &lt;memory&gt;
#include &lt;stdint.h&gt;
</span>
<span class="kt">void</span> <span class="n">World</span><span class="o">::</span><span class="n">Tick</span><span class="p">(</span><span class="kt">float</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[tick] %0.2</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After hooking the function we see that its just a normal <code class="language-plaintext highlighter-rouge">tick</code> function and is being executed quite freqeuently about 2 times per sec.</p><p><img data-proofer-ignore data-src="/assets/postimg/pwnadv4/tick.png" alt="tick" /></p><h2 id="enter-dlsym">Enter Dlsym</h2><hr /><p>Since now we can overwrite functions lets see how we can write data in <code class="language-plaintext highlighter-rouge">.bss</code> of the other libraries. We will use the <code class="language-plaintext highlighter-rouge">dlsym</code> function. This takes 2 arguments a handle and a symbol. The handle is for any open dynamic library and symbol is the symbol whose address we want. for the handle we will use the special argument <code class="language-plaintext highlighter-rouge">RTLD_NEXT</code> which finds the next occurence of the symbol.<br /> We’ll use <code class="language-plaintext highlighter-rouge">dlsym</code> to find the address of the <code class="language-plaintext highlighter-rouge">GameWorld</code> object which we saw was a global variable in the <code class="language-plaintext highlighter-rouge">.bss</code>.</p><h2 id="getting-our-player-object">Getting our Player Object</h2><hr /><p>For this part we would have to look at the classes in depth and see the relations between them. So I just followed Liveoverflow’s example of how we got to the player object from the <code class="language-plaintext highlighter-rouge">GameWorld</code> object. Just as how he did we’re going to get our <code class="language-plaintext highlighter-rouge">Player</code> object and try to print our name and mana.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span text-data=" Cpp "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">#include "libGameLogic.h"
#include &lt;set&gt;
#include &lt;dlfcn.h&gt;
#include &lt;map&gt;
#include &lt;functional&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;cfloat&gt;
#include &lt;memory&gt;
#include &lt;stdint.h&gt;
</span>
<span class="kt">void</span> <span class="n">World</span><span class="o">::</span><span class="n">Tick</span><span class="p">(</span><span class="kt">float</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ClientWorld</span> <span class="o">*</span><span class="n">world</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">ClientWorld</span> <span class="o">**</span><span class="p">)(</span><span class="n">dlsym</span><span class="p">(</span><span class="n">RTLD_NEXT</span><span class="p">,</span><span class="s">"GameWorld"</span><span class="p">)));</span>
    <span class="n">IPlayer</span> <span class="o">*</span><span class="n">iplayer</span> <span class="o">=</span> <span class="n">world</span><span class="o">-&gt;</span><span class="n">m_activePlayer</span><span class="p">.</span><span class="n">m_object</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[LO] IPlayer-&gt;GetPlayerName: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">iplayer</span><span class="o">-&gt;</span><span class="n">GetPlayerName</span><span class="p">());</span>
    <span class="n">Player</span> <span class="o">*</span><span class="n">player</span> <span class="o">=</span> <span class="p">((</span><span class="n">Player</span> <span class="o">*</span><span class="p">)(</span><span class="n">iplayer</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"[LO] player-&gt;m_mana: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">player</span><span class="o">-&gt;</span><span class="n">m_mana</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We see that this function updates frequently giving us sort of a live update each time we use our mana.</p><p><img data-proofer-ignore data-src="/assets/postimg/pwnadv4/info.png" alt="info" /></p><h2 id="our-first-hack">Our First Hack</h2><hr /><p>We’ll use this player object to increase our player speed and get our speed hack! Somehow the server trust the client in the position it provides and our speed hack is visible to other players as well.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span text-data=" Cpp "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">#include "libGameLogic.h"
#include &lt;set&gt;
#include &lt;dlfcn.h&gt;
#include &lt;map&gt;
#include &lt;functional&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;cfloat&gt;
#include &lt;memory&gt;
#include &lt;stdint.h&gt;
</span>
<span class="kt">void</span> <span class="n">World</span><span class="o">::</span><span class="n">Tick</span><span class="p">(</span><span class="kt">float</span> <span class="n">f</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ClientWorld</span> <span class="o">*</span><span class="n">world</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">ClientWorld</span> <span class="o">**</span><span class="p">)(</span><span class="n">dlsym</span><span class="p">(</span><span class="n">RTLD_NEXT</span><span class="p">,</span><span class="s">"GameWorld"</span><span class="p">)));</span>
    <span class="n">IPlayer</span> <span class="o">*</span><span class="n">iplayer</span> <span class="o">=</span> <span class="n">world</span><span class="o">-&gt;</span><span class="n">m_activePlayer</span><span class="p">.</span><span class="n">m_object</span><span class="p">;</span>
    <span class="n">Player</span> <span class="o">*</span><span class="n">player</span> <span class="o">=</span> <span class="p">((</span><span class="n">Player</span> <span class="o">*</span><span class="p">)(</span><span class="n">iplayer</span><span class="p">));</span>
    <span class="n">player</span><span class="o">-&gt;</span><span class="n">m_walkingSpeed</span> <span class="o">=</span> <span class="mi">99999</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pwn/'>Pwn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/game-hacking/" class="post-tag no-text-decoration" >game hacking</a> <a href="/tags/ld-preload/" class="post-tag no-text-decoration" >LD_PRELOAD</a> <a href="/tags/dlsym/" class="post-tag no-text-decoration" >dlsym</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PwnAdventure Part4 - Function Hijacking - EsharkyTheGreat's Personal Blog&url=/posts/pwn-adventure-part4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=PwnAdventure Part4 - Function Hijacking - EsharkyTheGreat's Personal Blog&u=/posts/pwn-adventure-part4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=PwnAdventure Part4 - Function Hijacking - EsharkyTheGreat's Personal Blog&url=/posts/pwn-adventure-part4/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DefCamp-21-Blindsight/">DefCamp-21 Blindsight Writeup</a><li><a href="/posts/pwn-adventure-part3/">PwnAdventure Part3 - Memory and Structs</a><li><a href="/posts/pwn-adventure-part2/">PwnAdventure Part2 - Recon</a><li><a href="/posts/pwn-adventure-part1/">PwnAdventure Part1 - Setup</a><li><a href="/posts/First-Post/">First Test Post</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/game-hacking/">game hacking</a> <a class="post-tag" href="/tags/dlsym/">dlsym</a> <a class="post-tag" href="/tags/ld-preload/">LD_PRELOAD</a> <a class="post-tag" href="/tags/bof/">bof</a> <a class="post-tag" href="/tags/brop/">BROP</a> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/fork/">fork</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/pwn-adventure-part5/"><div class="card-body"> <span class="timeago small" >Feb 10<i class="unloaded">2022-02-10T16:48:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PwnAdventure Part5 - More Hacks!!</h3><div class="text-muted small"><p> Developing More Hacks In the previous post I went over LD_PRELOAD to hijack functions and created the speed hack. In this post I’m going over and understanding other hacks that LiveOverflow made i...</p></div></div></a></div><div class="card"> <a href="/posts/pwn-adventure-part1/"><div class="card-body"> <span class="timeago small" >Jan 19<i class="unloaded">2022-01-19T12:02:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PwnAdventure Part1 - Setup</h3><div class="text-muted small"><p> What is this series about ? I recently came across LiverOverflow’s youtube series on PwnAdventure3. I got interested in this because it involves game hacking which I think is very cool. Please ...</p></div></div></a></div><div class="card"> <a href="/posts/pwn-adventure-part2/"><div class="card-body"> <span class="timeago small" >Jan 20<i class="unloaded">2022-01-20T12:15:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PwnAdventure Part2 - Recon</h3><div class="text-muted small"><p> Recon What we’ll be going over in this post is external recon of the game. What I mean by external recon is just getting and overview of how the game is working without going in detail and find...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pwn-adventure-part3/" class="btn btn-outline-primary" prompt="Older"><p>PwnAdventure Part3 - Memory and Structs</p></a> <a href="/posts/pwn-adventure-part5/" class="btn btn-outline-primary" prompt="Newer"><p>PwnAdventure Part5 - More Hacks!!</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/eshwars1210">EsharkyTheGreat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/game-hacking/">game hacking</a> <a class="post-tag" href="/tags/dlsym/">dlsym</a> <a class="post-tag" href="/tags/ld-preload/">LD_PRELOAD</a> <a class="post-tag" href="/tags/bof/">bof</a> <a class="post-tag" href="/tags/brop/">BROP</a> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/fork/">fork</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
